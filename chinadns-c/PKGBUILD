# Maintainer: banbanchs <memory.silentvoyage@gmail.com>

pkgname=chinadns-c
pkgver=1.1.7
pkgrel=1
pkgdesc="Fix weird things with DNS in China."
url="https://github.com/clowwindy/ChinaDNS-C/tree/master"
arch=("i686" "x86_64")
license=("MIT")
provides=()
conflicts=()
depends=("glibc")
source=("git+https://github.com/clowwindy/ChinaDNS-C.git#tag=$pkgver"
        "chinadns.service"
        "chinadns@.service")
md5sums=("SKIP"
         "e0b2ae89f66fc412b7a7e69d60f24cb6"
         "0497ed32d6acb40e03588a0f5e08dffb")

build() {
  cd "ChinaDNS-C"
  ./autogen.sh
  ./configure --datarootdir=/etc --prefix=/usr
  make \
    CFLAGS="$CPPFLAGS $CFLAGS" \
    LDFLAGS="$LDFLAGS"
}

package() {
  cd "ChinaDNS-C"
  make DESTDIR="$pkgdir" install

  install -Dm644 LICENSE "$pkgdir"/usr/share/licenses/$pkgname/LICENSE
  install -Dm644 "$srcdir/chinadns.service" "$pkgdir/usr/lib/systemd/system/chinadns.service"
}

# vim: ts=2 sw=2 et ft=sh
